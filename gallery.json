import os, json

BASE_DIR = os.path.dirname(os.path.abspath(__file__))
IMAGES_DIR = os.path.join(BASE_DIR, "images")

CATEGORIES = {
    "classic": "classic",
    "modern": "modern",
    "accessories": "accessories",
    "blackout": "blackout",
    "roller": "roller",
}

ALLOWED = {".jpg", ".jpeg", ".png", ".webp"}

items = []

for cat, folder in CATEGORIES.items():
    folder_path = os.path.join(IMAGES_DIR, folder)
    if not os.path.isdir(folder_path):
        continue

    for fname in sorted(os.listdir(folder_path)):
        ext = os.path.splitext(fname)[1].lower()
        if ext in ALLOWED:
            rel = f"images/{folder}/{fname}"
            items.append({"src": rel, "cat": cat, "alt": ""})

out_path = os.path.join(BASE_DIR, "gallery.json")
with open(out_path, "w", encoding="utf-8") as f:
    json.dump(items, f, ensure_ascii=False, indent=2)

print(f"âœ… Done! Generated {len(items)} images into gallery.json")
